{
  "schema": "rexis.llmrag.report.v1",
  "run_name": "rootkit-run-2508",
  "generated_at": "2025-08-24T22:51:48Z",
  "duration_sec": 171.449,
  "sample": {
    "sha256": "a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6",
    "source_path": "/home/andremmfaria/projects/rexis/samples/rootkit/decompressed/a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.exe"
  },
  "program": {
    "name": "a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.exe",
    "format": "Portable Executable (PE)",
    "language": "x86/little/32/default",
    "compiler": "Delphi",
    "image_base": "00400000",
    "size": 15515782,
    "sha256": "a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6"
  },
  "artifacts": {
    "features_path": "analysis/llmrag/llmrag-analysis-rootkit-run-2508/decompile-rootkit-run-2508/a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.features.json",
    "llmrag_path": "analysis/llmrag/llmrag-analysis-rootkit-run-2508/a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.llmrag.json",
    "retrieval": {
      "query_count": 18,
      "passage_count": 8,
      "queries": [
        "imports: activatekeyboardlayout, adjustwindowrectex, beep, beginpaint, bitblt, callnexthookex, callwindowproca, charlowera, charlowerbuffa, charnexta, chartooema, charupperbuffa, checkmenuitem, childwindowfrompoint, clienttoscreen, closeclipboard, closeenhmetafile, closehandle, closeservicehandle, cocreateinstance",
        "network indicators: http://127.0.0.1/shikong_new, http://wt.chaoweinet.com/shikong_new, t.Ht, kernel32.dll, kernel32.dll, oleaut32.dll, comctl32.dll",
        "ips: 127.0.0.1, 0.0.0.1, 127.0.0.1, 127.0.0.1",
        "file paths: /f, /Jt, /PM, /d/yy, /HC, /html",
        "user agents: User-Agent, Mozilla/3, User-Agent",
        "errors: Exception, Error, error, error, Error, error",
        "process injection via createprocessa, createremotethread, getprocaddress, getthreadcontext, loadlibrarya, loadlibraryexa, setthreadcontext, setwindowshookexa, suspendthread, virtualallocex, writeprocessmemory",
        "network communication using getcpinfo, sendmessagea",
        "crypto routines destroycursor, destroyicon, destroymenu, destroywindow, getdesktopwindow, getenhmetafiledescriptiona, imagelist_destroy, olesetmenudescriptor",
        "persistence mechanisms createservicea, getstartupinfoa, regcreatekeyexa, setwindowshookexa",
        "anti-debugging using closehandle, debugactiveprocess, findwindowa, gettextextentpoint32a, gettickcount, getwindowthreadprocessid, queryperformancecounter, unhandledexceptionfilter",
        "file_ops features: closehandle, createfilea, deletefilea, findfirstfilea, getopenfilenamea, readfile, writefile",
        "process_ops features: createprocessa, getcurrentprocessid, openprocess, terminateprocess",
        "system_info features: getcomputernamea, getdiskfreespacea, getsystemdirectorya, getsysteminfo, getversion, getversionexa",
        "ui features: dispatchmessagea, findwindowa, getcursorpos, getkeystate, getmessagepos, getmessagetime, getwindowrect, getwindowtexta, postmessagea, sendmessagea, setwindowpos, setwindowshookexa, showwindow",
        "compression features: freelibrary, loadlibrarya, loadlibraryexa",
        "misc features: filetimetodosdatetime, filetimetolocalfiletime, getdateformata, getlocaltime, getmessagetime, gettickcount, gettimezoneinformation, invalidaterect, killtimer, queryperformancecounter, settimer, sleep, updatewindow",
        "Program information: name=a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.exe, format=Portable Executable (PE), language=x86/little/32/default, compiler=Delphi, image_base=00400000, size=15515782, sha256=a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6"
      ],
      "notes": {
        "query_count": 18,
        "top_k_dense": 50,
        "top_k_keyword": 50,
        "join_mode": "rrf",
        "rerank_top_k": 0,
        "final_top_k": 8,
        "filters": {
          "sources": []
        },
        "ranker_model": "gpt-4o-mini",
        "embedding_model": "text-embedding-3-small",
        "metric": "cosine_similarity",
        "dense_hits": 507,
        "keyword_hits": 50,
        "fused_unique": 550,
        "elapsed_ms": 7768
      },
      "passages_original": [
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-15",
          "source": "malpedia",
          "title": null,
          "score": 0.9295774647887324
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-10",
          "source": "malpedia",
          "title": null,
          "score": 0.8813929313929314
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-5",
          "source": "malpedia",
          "title": null,
          "score": 0.866337630942788
        },
        {
          "doc_id": "file_pdf::146e57062c590ff3fd51f262f8060fc04f4823e3014d5fda625a8ee04871d91e::chunk-1",
          "source": "vxunderground",
          "title": null,
          "score": 0.6421817892896869
        },
        {
          "doc_id": "file_html::08eceae8c0e4410bf44b7b3acfbd7b62a4fc3537351b0ac70f050daa6f9146fe::chunk-0",
          "source": "malpedia",
          "title": "Full analysis on NJRAT",
          "score": 0.5
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-7",
          "source": "malpedia",
          "title": null,
          "score": 0.4919354838709677
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-6",
          "source": "malpedia",
          "title": null,
          "score": 0.4841269841269841
        },
        {
          "doc_id": "file_html::2d26af7a7bfafb0d3e22a57c4c803716b2db4848fcf04f2be0d45cea69a90245::chunk-2",
          "source": "malpedia",
          "title": "Dissecting Lumma Malware: Analyzing the Fake CAPTCHA and Obfuscation Techniques - Part 2",
          "score": 0.4841269841269841
        }
      ],
      "passages_used": [
        {
          "doc_id": "file_pdf::146e57062c590ff3fd51f262f8060fc04f4823e3014d5fda625a8ee04871d91e::chunk-1",
          "source": "vxunderground",
          "title": null,
          "score": 0.6421817892896869
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-15",
          "source": "malpedia",
          "title": null,
          "score": 0.9295774647887324
        },
        {
          "doc_id": "file_html::08eceae8c0e4410bf44b7b3acfbd7b62a4fc3537351b0ac70f050daa6f9146fe::chunk-0",
          "source": "malpedia",
          "title": "Full analysis on NJRAT",
          "score": 0.5
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-6",
          "source": "malpedia",
          "title": null,
          "score": 0.4841269841269841
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-5",
          "source": "malpedia",
          "title": null,
          "score": 0.866337630942788
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-7",
          "source": "malpedia",
          "title": null,
          "score": 0.4919354838709677
        },
        {
          "doc_id": "file_html::2d26af7a7bfafb0d3e22a57c4c803716b2db4848fcf04f2be0d45cea69a90245::chunk-2",
          "source": "malpedia",
          "title": "Dissecting Lumma Malware: Analyzing the Fake CAPTCHA and Obfuscation Techniques - Part 2",
          "score": 0.4841269841269841
        },
        {
          "doc_id": "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-10",
          "source": "malpedia",
          "title": null,
          "score": 0.8813929313929314
        }
      ]
    }
  },
  "llmrag": {
    "schema": "rexis.llmrag.classification.v1",
    "score": 0.85,
    "label": "malicious",
    "classification": [
      "rat",
      "stealer"
    ],
    "families": [
      "unknown_family"
    ],
    "capabilities": [
      "injection",
      "persistence",
      "anti-debug",
      "file_ops",
      "process_ops",
      "system_info",
      "networking",
      "crypto",
      "ui",
      "compression"
    ],
    "tactics": [
      "execution",
      "persistence",
      "defense-evasion",
      "credential-access",
      "collection",
      "exfiltration",
      "command-and-control"
    ],
    "evidence": [
      {
        "id": "evidence-1",
        "title": "Injection Capabilities",
        "detail": "Imports related to process injection such as CreateProcessA, CreateRemoteThread, and VirtualAlloc.",
        "severity": "error",
        "source": "features",
        "doc_ref": ""
      },
      {
        "id": "evidence-2",
        "title": "Persistence Mechanisms",
        "detail": "Uses CreateServiceA and RegCreateKeyExA for persistence.",
        "severity": "error",
        "source": "features",
        "doc_ref": ""
      },
      {
        "id": "evidence-3",
        "title": "Anti-Debugging Techniques",
        "detail": "Imports like DebugActiveProcess and GetTickCount suggest anti-debugging capabilities.",
        "severity": "warn",
        "source": "features",
        "doc_ref": ""
      },
      {
        "id": "evidence-4",
        "title": "NJRAT Characteristics",
        "detail": "The sample exhibits behaviors typical of NJRAT, such as remote control and data exfiltration.",
        "severity": "error",
        "source": "retrieval",
        "doc_ref": "file_html::08eceae8c0e4410bf44b7b3acfbd7b62a4fc3537351b0ac70f050daa6f9146fe::chunk-0"
      },
      {
        "id": "evidence-5",
        "title": "File Operations",
        "detail": "Capabilities to create, read, and delete files using CreateFileA, ReadFile, and DeleteFileA.",
        "severity": "warn",
        "source": "features",
        "doc_ref": ""
      },
      {
        "id": "evidence-6",
        "title": "Networking Capabilities",
        "detail": "Uses SendMessageA for potential network communication.",
        "severity": "warn",
        "source": "features",
        "doc_ref": ""
      }
    ],
    "uncertainty": "high",
    "notes": "The sample shows strong indicators of being a NJRAT variant with capabilities for remote access, data exfiltration, and persistence. guardrails:family_abstained(leak=true, ev=1)",
    "meta": {
      "model": "gpt-4o-2024-08-06",
      "temperature": 0.0,
      "max_tokens": 1024,
      "prompt_variant": "justification",
      "prompt_hash": "94ce90c7f672430832be080405c4298e26d2e8ba4c175c5097ccabd99e535c52",
      "passages_used": [
        "file_pdf::146e57062c590ff3fd51f262f8060fc04f4823e3014d5fda625a8ee04871d91e::chunk-1",
        "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-15",
        "file_html::08eceae8c0e4410bf44b7b3acfbd7b62a4fc3537351b0ac70f050daa6f9146fe::chunk-0",
        "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-6",
        "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-5",
        "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-7",
        "file_html::2d26af7a7bfafb0d3e22a57c4c803716b2db4848fcf04f2be0d45cea69a90245::chunk-2",
        "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-10"
      ],
      "prompts": [
        {
          "role": "system",
          "text": "You are a precise malware analyst. You must produce a JSON verdict following the given schema. If uncertain, set label='unknown' and uncertainty='high'. Prefer concise, actionable evidence.\n\n Output must be JSON only.\n\nReturn STRICT JSON only, no prose outside JSON. The JSON object MUST include keys:\n  schema=\"rexis.llmrag.classification.v1\", score (0..1), label (\"malicious\"|\"suspicious\"|\"benign\"|\"unknown\"),\n  classification (list of strings; e.g., ransomware, trojan, worm, downloader, dropper, rootkit, banker, stealer, backdoor, botnet, keylogger, adware, spyware, wiper, rat, cryptominer),\n  families (list of strings), capabilities (list of strings), tactics (list of strings),\n  evidence (list of objects with: id, title, detail, severity in {info,warn,error}, source in {features,retrieval}, doc_ref),\n  uncertainty in {\"low\",\"medium\",\"high\"} and optional notes.\nConstrain evidence to 4\u20138 diverse items. Use source=features for imports/sections-based inferences; use source=retrieval and doc_ref=<doc_id> to cite passages. Map capability names to analyst terminology (injection, persistence, networking, crypto, anti-debug, exfiltration, obfuscation, c2). Calibrate score heuristically: strong diverse capabilities with corroboration -> 0.75\u20130.95; single strong signal -> 0.45\u20130.65; weak/ambiguous -> 0.15\u20130.35; none -> \u22640.15. Prefer 1\u20133 concise classification tags that best describe the sample's high-level type."
        },
        {
          "role": "user",
          "text": "Context:\n- name: a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.exe\n- format: Portable Executable (PE)\n- language: x86/little/32/default\n- compiler: Delphi\n- image_base: 00400000\n- size: 15515782\n- sha256: a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6\n- capability:injection -> imports: createprocessa, createremotethread, getprocaddress, getthreadcontext, loadlibrarya, loadlibraryexa, setthreadcontext, setwindowshookexa, suspendthread, virtualalloc...\n- capability:network -> imports: getcpinfo, sendmessagea\n- capability:crypto -> imports: destroycursor, destroyicon, destroymenu, destroywindow, getdesktopwindow, getenhmetafiledescriptiona, imagelist_destroy, olesetmenudescriptor\n- capability:persistence -> imports: createservicea, getstartupinfoa, regcreatekeyexa, setwindowshookexa\n- capability:anti_debug -> imports: closehandle, debugactiveprocess, findwindowa, gettextextentpoint32a, gettickcount, getwindowthreadprocessid, queryperformancecounter, unhandledexceptionfilter\n- capability:file_ops -> imports: closehandle, createfilea, deletefilea, findfirstfilea, getopenfilenamea, readfile, writefile\n- capability:process_ops -> imports: createprocessa, getcurrentprocessid, openprocess, terminateprocess\n- capability:system_info -> imports: getcomputernamea, getdiskfreespacea, getsystemdirectorya, getsysteminfo, getversion, getversionexa\n- capability:ui -> imports: dispatchmessagea, findwindowa, getcursorpos, getkeystate, getmessagepos, getmessagetime, getwindowrect, getwindowtexta, postmessagea, sendmessagea\n- capability:compression -> imports: freelibrary, loadlibrarya, loadlibraryexa\n- capability:misc -> imports: filetimetodosdatetime, filetimetolocalfiletime, getdateformata, getlocaltime, getmessagetime, gettickcount, gettimezoneinformation, invalidaterect, killtimer, queryperfo...\n- section Headers: size=1024, entropy=1.8397, comment=, read=True, write=False, type=Default\n- section UPX0: size=1142784, entropy=6.4714, comment=, read=True, write=True, type=Default\n- section UPX1: size=434176, entropy=3.9423, comment=, read=True, write=True, type=Default\n- section .rsrc: size=49152, entropy=3.3349, comment=, read=True, write=True, type=Default\n- section .imports: size=12288, entropy=3.7536, comment=, read=True, write=True, type=Default\n- section .reloc: size=81920, entropy=6.6928, comment=, read=True, write=True, type=Default\n\nRetrieved Documents:\n[1] vxunderground (id=file_pdf::146e57062c590ff3fd51f262f8060fc04f4823e3014d5fda625a8ee04871d91e::chunk-1, source=vxunderground):  arg) { \\n\\[FAMILY] \\n } else { \\n [FAMILY](\\\\t[+] [FAMILY]: [ [ [FAMILY]@hostname port port:host:hostport pass ] | [FAMILY] ]); \\n [FAMILY](0); \\n } \\n try { \\n [FAMILY] = [FAMILY](); \\n [FAMILY] = host.substring(0, [FAMILY]('@')); \\n host = host.substring([FAMILY]('@') + 1); \\n [FAMILY] = [FAMILY](user, host, port); \\n if (!kex.equals()) \\n [FAMILY](kex, kex); \\n int rport = [FAMILY](foo.substring(0, [FAMILY](':'))); \\n foo = foo.substring([FAMILY](':') + 1); \\n [FAMILY] = foo.substring(0, [FAMILY](':')); \\n int lport = [FAMILY](foo.substring([FAMILY](':') + 1)); \\n [FAMILY](pass); \\n [FAMILY]([FAMILY], no); \\n session.connect(); \\n [FAMILY](rport, lhost, lport); \\[FAMILY] 20: [FAMILY] of [FAMILY]. \\n \\[FAMILY] leveraged to tunnel traffic is a [FAMILY] is a [FAMILY] \\nversion of [FAMILY] and can be executed with command-line parameters or with a \\nconfiguration [FAMILY] and its path...\n[2] malpedia (id=file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-15, source=malpedia):  input not full block\\n crypto/des: output not full block\\n crypto/des: input not full block\\n crypto/des: invalid buffer overlap\\n crypto/[FAMILY]: invalid hash state [FAMILY]\\n AES-128-CBC\\n AES-192-CBC\\n AES-256-CBC\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n -----[FAMILY]\\n [FAMILY]\\n [FAMILY]: unknown elliptic curve\\n [FAMILY]: cannot sign with hash function requested\\n [FAMILY]: [FAMILY]\\n [FAMILY]: internal [FAMILY]: cannot parse domain %q\\n [FAMILY]: unknown [FAMILY]\\n [FAMILY]: malformed tbs certificate\\n [FAMILY]: invalid version\\n [FAMILY]: malformed validity\\n [FAMILY]: malformed spki\\n [FAMILY]: malformed extensions\\n [FAMILY]: invalid authority info access\\n [FAMILY]: [FAMILY]\\n [FAMILY]: invalid constraint value: \\n [FAMILY]: [FAMILY] is malformed\\n [FAMILY]: cannot parse IP address of length \\n [FAMILY]: [FAMILY]\\n [FAMILY]: [FAMILY] ...\n[3] Full analysis on NJRAT (id=file_html::08eceae8c0e4410bf44b7b3acfbd7b62a4fc3537351b0ac70f050daa6f9146fe::chunk-0, source=malpedia): {\"title\": \"[FAMILY] | [FAMILY] | [FAMILY] of NJ [FAMILY] 0.7NC and 0.6.4\", \"extracted_text\": \"[FAMILY] | [FAMILY] | [FAMILY] of NJ [FAMILY] 0.7NC and 0.6.4\\[FAMILY] | [FAMILY] of NJ [FAMILY] 0.7NC and 0.6.4\\[FAMILY] on [FAMILY] 9, 2024\\[FAMILY]\\[FAMILY]\\[FAMILY] {0.7NC} of [FAMILY] on 17 [FAMILY] 2023 [FAMILY]-magazine- speaker. It was delivered by [FAMILY] [FAMILY] as a type of [FAMILY] ([FAMILY]). [FAMILY] do a range of things, like recording keystrokes, accessing [FAMILY] victim\\[FAMILY], stealing saved login information from web browsers, creating a way for attackers to control [FAMILY] victim\\[FAMILY] a remote [FAMILY], transferring files to and from [FAMILY] victim\\[FAMILY], seeing what\\[FAMILY] on [FAMILY] victim\\[FAMILY], making changes to files, processes, [FAMILY], and even allowing [FAMILY] attacker to update, remove, restart, close, disconnect, or change [FAMILY] name of t...\n[4] malpedia (id=file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-6, source=malpedia): haroshthi\\n Linear_B\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]: invalid whence\\n bufio: buffer full\\n bufio: negative count\\n [FAMILY]: token too long\\n bufio: tried to fill full buffer\\n invalid syntax\\n 6103515625\\n 152587890625\\n 762939453125\\n 3814697265625\\n 95367431640625\\n 11920928955078125\\n 59604644775390625\\n 1490116119384765625\\n 7450580596923828125\\n 37252902984619140625\\n 186264514923095703125\\n 14551915228366851806640625\\n 363797880709171295166015625\\n 28421709430404007...\n[5] malpedia (id=file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-5, source=malpedia):  not found\\n No functions exported\\n [FAMILY]'t fit: %08x\\n [FAMILY]: %w\\n [FAMILY]: %w\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n ntdll.dll\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]()\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY] io.[FAMILY]()...\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n fail to read [FAMILY] table length: %v\\n fail to read section relocations: %v\\n [FAMILY] %d\\n [FAMILY]\\n [FAMILY]\\n extended attribute name too large\\n [FAMILY]\\n [FAMILY]\\n ws2_32.dll\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [pivot] [FAMILY] data length\\n D:(A;;0x1f019f;;;WD)\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY...\n[6] malpedia (id=file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-7, source=malpedia):  ^r[0-9a-zA-Z]{23,50}$\\n ^0x[a-fA-F0-9]{40}$\\n ^0x[0-9a-fA-F]{40}$\\n ^([a-zA-Z0-9]){32,}$\\n fhbohimaelbohpjbbldcngcnapndodjp\\n [FAMILY]\\n pdadjkfkgcafgbceimcpbkalnfnepbnk\\n amkmjjmmflddogmhpjloimipbofnfjih\\n [FAMILY]\\n cjelfplplebdjjenllpjcblmjkfcffne\\n [FAMILY]\\n [FAMILY]\\n cgeeodpfagjceefieflmdfphplkenlfk\\n [FAMILY]\\n fihkakfobkmkjojpchpfgcmhfjnmnfpi\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n \\\\[FAMILY]\\\\\\n [FAMILY]\\n \\\\atomic\\\\[FAMILY]\\\\leveldb\\n wallet.dat\\n [FAMILY]\\n \\\\[FAMILY]\\\\\\n wallet.dat\\n \\\\[FAMILY]\\\\\\n multidoge.wallet\\n \\\\[FAMILY]\\\\\\n address.db\\n config.inc.php\\n ShareX_H_\\n [FAMILY]\\n \\\\[FAMILY]\\\\[FAMILY]\\\\\\n [FAMILY]\\n \\\\[FAMILY]\\\\[FAMILY]\\\\\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n browsedata.db\\n \\\\[FAMILY]++\\\\backup\\\\\\n [FAMILY]\\n \\\\snowflake-ssh\\\\\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n auth.json\\n COMPOSER_HOME\\n \\\\[FAMILY]\\\\[FAMILY]\\\\\\n winauth.xml\\n accounts....\n[7] Dissecting Lumma Malware: Analyzing the Fake CAPTCHA and Obfuscation Techniques - Part 2 (id=file_html::2d26af7a7bfafb0d3e22a57c4c803716b2db4848fcf04f2be0d45cea69a90245::chunk-2, source=malpedia): [FAMILY] is a glimpse of [FAMILY] extracted code.\\[FAMILY] code that assigns random numbers to different variables.\\[FAMILY]\\neval\\nfunction to execute obfuscated code, which includes a\\nwindow.close()\\nfunction.\\[FAMILY] illustrates how this can be accomplished:\\nimport sys\\nimport re\\n\\ndef extract_scripts(binary_file):\\n try:\\n with open(binary_file, \\\"rb\\\") as f:\\n binary_data = f.read()\\n \\n # [FAMILY] to [FAMILY] ([FAMILY] it's encoded in utf-8 or similar encoding)\\n try:\\n data = binary_data.decode(\\\"utf-8\\\", errors='ignore')\\n [FAMILY]:\\n print(\\\"[-] [FAMILY] to decode binary data.\\\")\\n sys.exit(1)\\n \\n # [FAMILY] contents using regex\\n scripts = re.findall(r'<[FAMILY].*?>(.*?)</[FAMILY]>', data, re.DOTALL | re.IGNORECASE)\\n \\n if scripts:\\n for i, [FAMILY] in enumerate(scripts, start=1):\\n print(f\\\"[+] [FAMILY] {i}\\\\n{[FAMILY].strip()}\\\\n\\\")\\n else:\\n print(\\\"[-] No [FAMILY]....\n[8] malpedia (id=file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-10, source=malpedia):  [FAMILY]\\n [FAMILY]\\n local-addr\\n http: request too large\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]: \\n silence-semicolons\\n http: [FAMILY]\\n [FAMILY]\\n <!DOCTYPE HTML\\n image/x-icon\\n image/bmp\\n image/gif\\n image/gif\\n image/png\\n image/jpeg\\n FORM AIFF\\n audio/aiff\\n audio/mpeg\\n application/ogg\\n audio/midi\\n application/vnd.ms-fontobject\\n font/collection\\n font/[FAMILY]\\n application/x-gzip\\n application/zip\\n application/wasm\\n \\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n net/http: skip alternate protocol\\n http: [FAMILY]\\n net/http: timeout awaiting response headers\\n http: read on closed response body\\n [FAMILY]\\n bad [FAMILY] [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n identity\\n [FAMILY]\\n [FAMILY]: chunked\\n\\n [FAMILY]\\n [FAMILY]: \\n [FAMILY]\\n [FAMILY]\\n No [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n [FAMILY]\\n ...\n\nTasks:\n- Classify the sample into a known malware family (or 'unknown' if undecidable).\n- Justify the classification using both static features and retrieved evidence; cite doc ids in 'evidence'.\n- Return STRICT JSON only, following the required schema."
        }
      ]
    },
    "guardrails": {
      "blind_label": "malicious",
      "blind_families": [
        "unknown"
      ],
      "blind_score": 0.85,
      "retrieval_evidence_count": 1,
      "min_retrieval_evidence": 2,
      "name_leak_detected": true
    }
  },
  "guardrails": {
    "redacted_names": [
      "APT28",
      "APT29",
      "APT32",
      "APT33",
      "APT41",
      "Accept-Charset",
      "Accept-Encoding",
      "Accept-Language",
      "AddFontMemResourceEx",
      "AddFontResourceExW",
      "AdjustWindowRect",
      "AgentTesla",
      "Already Reported",
      "AmsiScanBuffer",
      "Analysis",
      "Analyzing the Fake CAPTCHA and",
      "AppData",
      "Assuming",
      "Atomic Wallet",
      "AtomicWallet",
      "August",
      "Authorization",
      "Authy Desktop",
      "Avaddon",
      "BEGIN X509 CRL",
      "Babuk",
      "BackupRead",
      "BadRabbit",
      "Base64 encoded PowerShell one-liner",
      "BeginPaint",
      "Bidi_Control",
      "Binance",
      "BitKinex",
      "Bither",
      "Bits",
      "Breachnova",
      "BringWindowToTop",
      "Browser",
      "Bytecoin",
      "Cache-Control",
      "Carbanak",
      "Cerber",
      "ClassicFTP",
      "ClientAuthType",
      "Clop",
      "CloseIdleConnections called",
      "CoGetClassObject",
      "CoInitializeEx",
      "CoUninitialize",
      "Cobalt Strike",
      "Code snippet",
      "CoffeeCup Software",
      "Coin98 Wallet",
      "Conflict",
      "Connection",
      "Content",
      "Content Type",
      "Content-Disposition",
      "Content-Encoding",
      "Content-Language",
      "Content-Length",
      "Content-Range",
      "Content-Type",
      "Conti",
      "Convert binary data",
      "Cookie.Value",
      "Copy",
      "CopyEnhMetaFileW",
      "CreateActCtxW",
      "CreateBitmap",
      "CreateDIBSection",
      "CreateIconIndirect",
      "CreateMenu",
      "CreatePatternBrush",
      "CreateProcessW",
      "CryptoLocker",
      "CyberChef",
      "Cyberfox",
      "DATA frame with stream",
      "DSA-SHA256",
      "DarkSide",
      "DashCore",
      "Default.ppx",
      "DeferWindowPos",
      "DeleteEnhMetaFile",
      "DeleteObject",
      "DeluxeFTP",
      "Deprecated",
      "DestroyIcon",
      "DestroyMenu",
      "DeviceCapabilitiesW",
      "Dissecting Lumma Malware",
      "DocumentPropertiesW",
      "Documents",
      "DownloadManagerIDM",
      "DragFinish",
      "DragQueryFileW",
      "DrawMenuBar",
      "DrawThemeBackground",
      "Dridex",
      "Dynamic Link Library",
      "ECDSA-SHA1",
      "ECDSA-SHA256",
      "ECDSA-SHA384",
      "ECDSAWithP256AndSHA256",
      "ESTdb2.dat",
      "EasyFTP",
      "Ed25519 public key",
      "Ed25519 verification failure",
      "ElectronCash",
      "Elem",
      "Emotet",
      "EmptyClipboard",
      "EnableMenuItem",
      "Entering into",
      "EnumChildWindows",
      "Environment",
      "ErrCode",
      "Error",
      "Error enabling Transport HTTP",
      "Error finalizing section",
      "EvilCorp",
      "ExcludeClipRect",
      "Exodus",
      "ExpanDrive",
      "Expectation Failed",
      "ExtractIconW",
      "FIN7",
      "FIN_WAIT1",
      "FTPGetter",
      "FTPInfo",
      "FTPInfo_CFG",
      "FTPInfo_XML",
      "Failed",
      "Failed Dependency",
      "Field",
      "Field index out",
      "FieldByNameFunc",
      "File",
      "FileZilla",
      "FileZilla1",
      "FileZilla_PEM",
      "Filezilla",
      "Find all the script tag",
      "FindResourceW",
      "FlashFXP",
      "Flock",
      "For AES",
      "Forbidden",
      "FormBook",
      "FormatInt base",
      "Framer",
      "Full analysis",
      "GNU Privacy Guard",
      "GODEBUG sys",
      "Gateway Timeout",
      "Generic Code Beautify",
      "GetBkColor",
      "GetClassNameW",
      "GetConsoleWindow",
      "GetCurrentThreadId",
      "GetDC failed",
      "GetDesktopWindow",
      "GetDlgItem",
      "GetDpiForWindow",
      "GetEnhMetaFileHeader",
      "GetEnhMetaFileW",
      "GetErrorInfo",
      "GetExitCodeThread",
      "GetIconInfo",
      "GetKeyState",
      "GetMenuItemCount",
      "GetNamedPipeHandleStateW",
      "GetOpenFileNameW",
      "GetProfileStringW",
      "GetRawInputData",
      "GetSaveFileNameW",
      "GetSubMenu",
      "GetSysColor",
      "GetSysColorBrush",
      "GetSystemMenu",
      "GetTextColor",
      "GetTextExtentPoint32W",
      "GetTextMetricsW",
      "GetThemePartSize",
      "GetThemeTextExtent",
      "GetVersion",
      "GetViewportOrgEx",
      "GetWindowLongW",
      "GetWindowRect",
      "GetWindowThreadProcessId",
      "GitHub Desktop",
      "Gootkit",
      "Growtopia",
      "HEADERS frame with stream",
      "Hancitor",
      "Here",
      "Hex_Digit",
      "History.json",
      "How RAT works",
      "IA5String contains invalid character",
      "IDS_Binary_Operator",
      "IDS_Trinary_Operator",
      "IcedID",
      "Idempotency-Key",
      "ImageList_AddMasked",
      "ImageList_Create",
      "ImageList_DrawEx",
      "ImageList_ReplaceIcon",
      "IncrediMail",
      "IndexedDB",
      "InitCommonControlsEx",
      "InitializeProcThreadAttributeList",
      "InstAltMatch",
      "Insufficient Storage",
      "Integer.parseInt",
      "IsDialogMessageW",
      "JDownloader",
      "JSOCKS-like tool. This tool",
      "JSch jsch",
      "Jaxx Liberty",
      "Jigsaw",
      "KDC SRV records found for",
      "Kalypso Media",
      "KardiaChain",
      "Kernel32.dll",
      "Key",
      "LavaServer",
      "Len",
      "Length Required",
      "Litecoin",
      "LoadImageW",
      "LoadWithPartialName",
      "Local Extension Settings",
      "Local Storage",
      "LocalAlloc",
      "LocalAppData",
      "Location",
      "LockBit",
      "LogonUserW",
      "LokiBot",
      "LookupPrivilegeDisplayNameW",
      "Loop Detected",
      "Mailbird",
      "Mailspring",
      "MakeFunc with non-Func type",
      "Malayalam",
      "MapIter.Next called",
      "Masaram_Gondi",
      "Math Wallet",
      "Max-Forwards",
      "Maze",
      "Medefaidrin",
      "Meetei_Mayek",
      "Mende_Kikakui",
      "Meroitic_Cursive",
      "Message",
      "Method",
      "Method Not Allowed",
      "Microsoft",
      "Mime-Version",
      "Minecraft McSkill",
      "Minecraft RedServer",
      "Minecraft VimeWorld",
      "Minecraft loliland",
      "Misdirected Request",
      "Modified-Since",
      "Mongolian",
      "MonitorFromWindow",
      "Moonchild Productions",
      "MoveWindow",
      "Mozilla",
      "Muon Snowflake",
      "NDSites.ini",
      "NJRAT",
      "NJRat was first seen",
      "Nandinagari",
      "NetDrive",
      "NetSarang1",
      "Netwalker",
      "New",
      "New-Object System.Net.HttpListener",
      "New_Tai_Lue",
      "NexusFile1",
      "NoDefaultCurrentDirectoryInExePath",
      "Non-Authoritative Information",
      "NordPass",
      "Not Acceptable",
      "NotPetya",
      "Notepad",
      "NotifyWinEvent",
      "NovaFTP",
      "NumOut",
      "Obfuscation Techniques - Part",
      "Old_Hungarian",
      "Old_Italic",
      "Old_North_Arabian",
      "Old_Persian",
      "Old_Sogdian",
      "Old_South_Arabian",
      "Old_Turkic",
      "OleAut32.dll",
      "OleInitialize",
      "OleSetContainedObject",
      "Once the script successfully decodes",
      "OpenThemeData",
      "OpenThreadToken",
      "Opera Mail",
      "Other_Default_Ignorable_Code_Point",
      "Other_Lowercase",
      "Out",
      "Out-Null",
      "Out-String",
      "PKCS1WithSHA256",
      "POST request",
      "PRIORITY frame with stream",
      "Pahawh_Hmong",
      "Pale Moon",
      "ParseFloat",
      "ParseUint",
      "Pattern_Syntax",
      "PeekMessageW",
      "Permanent Redirect",
      "Petya",
      "Phoenician",
      "Pixel Worlds",
      "Poc",
      "PocoMail",
      "PocoMail1",
      "Pocomail",
      "PortForwardingL.java.html",
      "PostboxApp",
      "PowerShell script processes several values",
      "PowerShell script. Within this script",
      "Process32Next",
      "ProgramFiles",
      "Programs",
      "Proxy Authentication Required",
      "Proxy-Authorization",
      "Proxy-Connection",
      "PssCaptureSnapshot",
      "QakBot",
      "Quotation_Mark",
      "RAT",
      "RAT version",
      "REvil",
      "ReadStdoutStderr",
      "RedLine",
      "Reflection.Assembly",
      "RegConnectRegistryW",
      "RegDeleteValueW",
      "RegLoadMUIStringW",
      "RegisterRawInputDevices",
      "Remcos",
      "RemoveFontResourceExW",
      "RemoveMenu",
      "Resulting immediate value won",
      "Roaming",
      "RoundTrip failure",
      "RoundTrip retrying after failure",
      "RtlCopyMemory",
      "RtlDefaultNpAcl",
      "RtlNtStatusToDosErrorNoTeb",
      "Ryuk",
      "SAN rfc822Name",
      "SDRTrunk",
      "SHA256-RSA",
      "SHA512-RSAPSS",
      "SafeArrayCreate",
      "SafeArrayPutElement",
      "Samaritan",
      "Sandworm",
      "Saturn Wallet",
      "Script",
      "Script found",
      "Security defines NJRat",
      "SelectObject",
      "SelectObject failed",
      "Sentence_Terminal",
      "Server closed",
      "ServerList.cfg",
      "ServerList.xml",
      "Service Pack",
      "Session session",
      "Set-Cookie",
      "SetActiveWindow",
      "SetBkColor",
      "SetBoundary called after write",
      "SetClipboardData",
      "SetCursorPos",
      "SetMenuDefaultItem",
      "SetParent",
      "SetStretchBltMode",
      "Settings.reg",
      "ShareX",
      "ShellExecuteW",
      "Shell_NotifyIconW",
      "Sherrod FTP",
      "ShowWindow",
      "Signal",
      "SignatureScheme",
      "SilverTerrier",
      "SimonTatham",
      "Size",
      "SizeofResource",
      "Slack",
      "Sodinokibi",
      "Soft_Dotted",
      "Software",
      "Something went wrong",
      "Sora_Sompeng",
      "Squirrel",
      "Staff-FTP",
      "Start Menu",
      "Startup",
      "Store",
      "StrictHostKeyChecking",
      "String",
      "String lhost",
      "String user",
      "SwapBuffers",
      "Switching Protocols",
      "Syloti_Nagri",
      "SysFreeString",
      "SysStringLen",
      "System",
      "System.Web",
      "System.Web.HttpUtility",
      "System.exit",
      "System.out.println",
      "SystemParametersInfoW",
      "TA2101",
      "TA505",
      "TA542",
      "TA551",
      "TA575",
      "TA800",
      "TON Crystal Wallet",
      "TS3Client",
      "Tai_Viet",
      "Terminal_Punctuation",
      "Terra Station",
      "The",
      "The Bat",
      "This indicates that",
      "This malicious software can",
      "This marks the beginning",
      "This reveals the obfuscated sections",
      "Thunderbird",
      "Ticket not yet valid",
      "Total Commander",
      "TrackMouseEvent",
      "TrackPopupMenu",
      "TrackPopupMenuEx",
      "Trailer",
      "Transfer-Encoding",
      "TransparentBlt",
      "TrickBot",
      "Turla",
      "Type.Implements",
      "URL parameter named",
      "Ugaritic",
      "UnregisterClassW",
      "Untrusted",
      "Upgrade Required",
      "UrlDecode",
      "Usage",
      "User Data",
      "User-Agent",
      "User32.dll",
      "UserName",
      "UserProfile",
      "Users",
      "VBS file containing obfuscated PowerShell",
      "Value.SetIterKey called before Next",
      "Variant Also Negotiates",
      "Visual Basic Script",
      "Vitalwerks DUC",
      "Vitalwerks DUC x64",
      "Void Main",
      "Wait was already called",
      "WannaCry",
      "WhatsApp",
      "Windows",
      "Wizard Spider",
      "WriteProcessMemory",
      "Www-Authenticate",
      "X25519 key encoded with illegal",
      "X509 CRL",
      "XENIX semaphores available",
      "XWorm",
      "Zanabazar_Square",
      "Zero",
      "Zeus",
      "advapi32.dll",
      "aes128-cts",
      "aes128-cts-hmac-sha1",
      "aes128-cts-hmac-sha256",
      "aes128-sha1",
      "aes128-sha2",
      "aes256-cts",
      "aes256-cts-hmac-sha384",
      "aes256-sha1",
      "and the Windows registry",
      "anonymous but has PkgPath set",
      "arcfour-hmac-md5",
      "avx512ifma",
      "avx512vaes",
      "avx512vbmi",
      "avx512vbmi2",
      "avx512vl",
      "avx512vpclmulqdq",
      "backdoor",
      "backdoor that simulates",
      "bad argSize",
      "base64-encoded DLL",
      "bufio.Scanner",
      "camellia128-cts",
      "camellia128-cts-cmac",
      "camellia256-cts-cmac",
      "can use CyberChef",
      "chacha20",
      "cloverWallet",
      "code. After modifying the VBS",
      "comctl32.dll",
      "confCons.xml",
      "context.Request",
      "context.Request.Url",
      "context.Request.httpmethod",
      "context.Response",
      "crc32",
      "crypt32.dll",
      "custom Java compiled",
      "demonstrative. However",
      "des-cbc-md5",
      "des3-cbc-md5",
      "email using phishing. Red Packet",
      "environment variable contains NUL",
      "error mashaling PAEncTSEnc",
      "except Exception",
      "except FileNotFoundError",
      "except UnicodeDecodeError",
      "execute this DLL",
      "failed Bidi Rule",
      "foo.indexOf",
      "get the real DLL",
      "guildWallet",
      "hex into CyberChef and set",
      "host.indexOf",
      "http2",
      "http2.Transport",
      "http2debug",
      "http2server",
      "illegal AppendInt",
      "inCount",
      "includes encoded PowerShell code. This",
      "invalid Huffman-encoded data",
      "invalid NameConstraints extension",
      "invalid NumericString",
      "invalid UTF",
      "invalid Value",
      "jDownloader",
      "jaxxLiberty",
      "jsch.getSession",
      "kernel32.dll",
      "killing Cmd",
      "listener.GetContext",
      "listener.IsListening",
      "listener.Prefixes.Add",
      "listener.Start",
      "localPath",
      "mRemoteNG",
      "malformed HTTP status code",
      "malformed MIME header",
      "malformed MIME header line",
      "malformed OID",
      "malformed extension OID field",
      "malicious and highly obfuscated VBS",
      "md5WithRSAEncryption-CmsOID",
      "mismatch between ABI description and",
      "n10 http",
      "n11 https",
      "n15",
      "nAfter beautifying the code",
      "nAfter obtaining the data",
      "nAfter patching and",
      "nAfter persistence VBS goes for",
      "nAfter printing the shell code",
      "nAnother Java tool that was",
      "nBeautification",
      "nBut let",
      "nBy looking",
      "nDebugging the JavaScript",
      "nDecrypting obfuscated code using CyberChef",
      "nExecutive Summary",
      "nExploitation",
      "nFigure",
      "nFirst obfuscation",
      "nFrom backdoor",
      "nHigh-Level Technical Summary",
      "nHkb",
      "nHow RAT works",
      "nInitial Stage",
      "nIt was Invoking its VAI",
      "nNJRAT",
      "nPHF",
      "nPublished",
      "nSHA256",
      "nSecond Obfuscation",
      "nThe",
      "nThe VBS has its third",
      "nThe code also shows that",
      "nThe first backdoor",
      "nThe first script tag contains",
      "nThe following example Python script",
      "nThe initial executable comprises",
      "nThe second script utilizes the",
      "nThen the command",
      "nThird obfuscation",
      "nThis",
      "nThis analysis comprises two samples",
      "nThis final exploit has",
      "nThis stage consists",
      "nThis version",
      "nTo facilitate the lateral movement",
      "nUpon execution",
      "nUsing",
      "nWe can beautify the JavaScript",
      "nWe pass the final variables",
      "nWith the JavaScript code dumped",
      "nWith the main code and",
      "nZhX",
      "nby Osama Ellahi",
      "new JSch",
      "nil Request.URL",
      "nil Type",
      "npublic class PortForwardingR",
      "nremote code execution capabilities. Once",
      "obfuscated PowerShell code",
      "obfuscating the malicious DLL",
      "oleaut32.dll",
      "qBittorrent",
      "qBittorrent.ini",
      "rc4-hmac",
      "reflect.Copy",
      "reflect.MakeFunc",
      "reflect.MakeMapWithSize",
      "reflect.MapIter.SetKey",
      "reflect.Set",
      "reflect.StructOf",
      "reflect.Value.Call",
      "reflect.Value.Equal",
      "reflect.Value.Grow",
      "reflect.Value.Int",
      "reflect.Value.Pointer",
      "reflect.Value.SetComplex",
      "reflect.Value.SetInt",
      "reflect.Value.SetMapIndex",
      "reflect.Value.Slice3",
      "reflect.Value.Uint",
      "reflect.nameFrom",
      "remote access trojan",
      "request.contentlength64",
      "requestUrl",
      "requestUrl.LocalPath",
      "response.StatusCode",
      "returned zero Value",
      "roninWallet",
      "routes.Get_Item",
      "rsaES-OAEP-ENV-OID",
      "rsaEncryption-EnvOID",
      "server CertificateVerify",
      "server sent two HelloRetryRequest messages",
      "session.setConfig",
      "session.setPassword",
      "session.setPortForwardingR",
      "sha1",
      "short read from Rand",
      "sixteen zeros because the AES",
      "string with base64",
      "strings.Reader.Seek",
      "support Ed25519",
      "the AES decryption key",
      "the DLL",
      "the JSOCKS tool",
      "the open source JSOCKS tool11",
      "the port forwarding Java tool",
      "the startup folder. This technique",
      "the terminal. This command involves",
      "this VBS file performs deobfuscation",
      "transport got GOAWAY with error",
      "two primary stages. The initial",
      "u2018",
      "u2018kmd",
      "u2019",
      "u2019C",
      "u2019s",
      "u2019s camera",
      "u2019s computer",
      "u2019s computer from",
      "u2019s further exploitation and malicious",
      "u2019s screen",
      "u2019s see how the exploit",
      "u2019t know what this code",
      "u201cVAI",
      "u201d method within the DLL",
      "u2026",
      "unexpected InstFail",
      "unknown Renegotiation value",
      "unsafe.Pointer",
      "unsupported SSLv2 handshake received",
      "uses AES encryption",
      "using the yWaUTuYIQuUWknat method",
      "various variables. Further down",
      "was base64 encoded",
      "wglCreateContext",
      "wglDeleteContext",
      "wglGetLayerPaletteEntries",
      "wglShareLists",
      "with PowerShell and real binary",
      "with the name utah-Robert",
      "woff2",
      "wrong Ed25519 public key size",
      "x509",
      "x509usefallbackroots",
      "zero Value"
    ],
    "redaction_counts": {
      "server sent two HelloRetryRequest messages": 1,
      "unsupported SSLv2 handshake received": 1,
      "invalid NameConstraints extension": 1,
      "X25519 key encoded with illegal": 1,
      "SetBoundary called after write": 1,
      "malformed extension OID field": 1,
      "wrong Ed25519 public key size": 1,
      "invalid Huffman-encoded data": 1,
      "Ed25519 verification failure": 1,
      "unknown Renegotiation value": 1,
      "malformed MIME header line": 1,
      "server CertificateVerify": 1,
      "ECDSAWithP256AndSHA256": 1,
      "invalid NumericString": 1,
      "malformed MIME header": 1,
      "short read from Rand": 1,
      "x509usefallbackroots": 1,
      "Content-Disposition": 2,
      "Proxy-Authorization": 4,
      "Ed25519 public key": 1,
      "Transfer-Encoding": 8,
      "failed Bidi Rule": 1,
      "Content-Encoding": 3,
      "Www-Authenticate": 3,
      "Content-Language": 1,
      "avx512vpclmulqdq": 1,
      "Proxy-Connection": 2,
      "support Ed25519": 1,
      "Accept-Language": 1,
      "PKCS1WithSHA256": 1,
      "SignatureScheme": 1,
      "Accept-Encoding": 6,
      "Content-Length": 13,
      "BEGIN X509 CRL": 1,
      "ClientAuthType": 1,
      "Modified-Since": 4,
      "SAN rfc822Name": 1,
      "Accept-Charset": 3,
      "malformed OID": 1,
      "Content-Range": 2,
      "Cache-Control": 4,
      "SHA512-RSAPSS": 1,
      "Authorization": 3,
      "Max-Forwards": 3,
      "Mime-Version": 1,
      "Content Type": 1,
      "Content-Type": 6,
      "ECDSA-SHA384": 1,
      "ECDSA-SHA256": 1,
      "avx512vbmi2": 1,
      "GODEBUG sys": 1,
      "invalid UTF": 1,
      "avx512vaes": 1,
      "avx512ifma": 1,
      "DSA-SHA256": 1,
      "ECDSA-SHA1": 1,
      "avx512vbmi": 1,
      "Set-Cookie": 5,
      "SHA256-RSA": 1,
      "Connection": 8,
      "User-Agent": 3,
      "Location": 3,
      "X509 CRL": 1,
      "chacha20": 1,
      "avx512vl": 1,
      "Message": 4,
      "String": 10,
      "Failed": 3,
      "Error": 17,
      "Field": 8,
      "sha1": 1,
      "x509": 20,
      "Size": 7,
      "Key": 10,
      "NoDefaultCurrentDirectoryInExePath": 1,
      "environment variable contains NUL": 1,
      "RoundTrip retrying after failure": 1,
      "transport got GOAWAY with error": 1,
      "Proxy Authentication Required": 1,
      "Error enabling Transport HTTP": 1,
      "Non-Authoritative Information": 1,
      "CloseIdleConnections called": 1,
      "malformed HTTP status code": 1,
      "PRIORITY frame with stream": 1,
      "HEADERS frame with stream": 1,
      "Wait was already called": 1,
      "Variant Also Negotiates": 1,
      "DATA frame with stream": 1,
      "Insufficient Storage": 1,
      "Something went wrong": 3,
      "Misdirected Request": 1,
      "Switching Protocols": 1,
      "unexpected InstFail": 1,
      "Method Not Allowed": 1,
      "Permanent Redirect": 1,
      "Expectation Failed": 1,
      "Failed Dependency": 1,
      "RoundTrip failure": 1,
      "Already Reported": 1,
      "Upgrade Required": 1,
      "http2.Transport": 1,
      "Length Required": 1,
      "nil Request.URL": 1,
      "Idempotency-Key": 1,
      "Gateway Timeout": 1,
      "Not Acceptable": 1,
      "Server closed": 1,
      "Loop Detected": 1,
      "InstAltMatch": 1,
      "Cookie.Value": 1,
      "advapi32.dll": 2,
      "killing Cmd": 1,
      "http2server": 1,
      "crypt32.dll": 1,
      "http2debug": 1,
      "Forbidden": 1,
      "UserName": 5,
      "Conflict": 1,
      "Trailer": 2,
      "ErrCode": 1,
      "Content": 2,
      "Framer": 1,
      "Signal": 4,
      "http2": 1,
      "woff2": 1,
      "Out": 5,
      "IA5String contains invalid character": 1,
      "InitializeProcThreadAttributeList": 1,
      "Resulting immediate value won": 1,
      "LookupPrivilegeDisplayNameW": 1,
      "md5WithRSAEncryption-CmsOID": 1,
      "error mashaling PAEncTSEnc": 1,
      "RtlNtStatusToDosErrorNoTeb": 1,
      "KDC SRV records found for": 1,
      "wglGetLayerPaletteEntries": 1,
      "GetNamedPipeHandleStateW": 1,
      "GetWindowThreadProcessId": 1,
      "Error finalizing section": 2,
      "RegisterRawInputDevices": 1,
      "aes256-cts-hmac-sha384": 1,
      "aes128-cts-hmac-sha256": 1,
      "OleSetContainedObject": 1,
      "SystemParametersInfoW": 1,
      "ImageList_ReplaceIcon": 1,
      "GetTextExtentPoint32W": 1,
      "RemoveFontResourceExW": 1,
      "aes128-cts-hmac-sha1": 1,
      "Ticket not yet valid": 1,
      "GetEnhMetaFileHeader": 1,
      "camellia256-cts-cmac": 2,
      "rsaEncryption-EnvOID": 1,
      "InitCommonControlsEx": 1,
      "camellia128-cts-cmac": 1,
      "AddFontMemResourceEx": 1,
      "DrawThemeBackground": 1,
      "DeviceCapabilitiesW": 1,
      "SelectObject failed": 1,
      "ImageList_AddMasked": 1,
      "RegConnectRegistryW": 1,
      "DocumentPropertiesW": 1,
      "SafeArrayPutElement": 1,
      "CreatePatternBrush": 1,
      "PssCaptureSnapshot": 1,
      "SetMenuDefaultItem": 1,
      "GetCurrentThreadId": 1,
      "rsaES-OAEP-ENV-OID": 1,
      "WriteProcessMemory": 1,
      "AddFontResourceExW": 1,
      "CreateIconIndirect": 1,
      "GetThemeTextExtent": 1,
      "DeleteEnhMetaFile": 1,
      "SetStretchBltMode": 1,
      "GetProfileStringW": 1,
      "MonitorFromWindow": 1,
      "GetExitCodeThread": 1,
      "Shell_NotifyIconW": 1,
      "RegLoadMUIStringW": 1,
      "TrackPopupMenuEx": 1,
      "AdjustWindowRect": 1,
      "arcfour-hmac-md5": 1,
      "GetSaveFileNameW": 1,
      "wglCreateContext": 1,
      "ImageList_Create": 1,
      "CoGetClassObject": 1,
      "BringWindowToTop": 1,
      "CreateDIBSection": 1,
      "GetThemePartSize": 1,
      "IsDialogMessageW": 1,
      "ImageList_DrawEx": 1,
      "GetViewportOrgEx": 1,
      "CopyEnhMetaFileW": 1,
      "SetClipboardData": 1,
      "GetConsoleWindow": 1,
      "GetDesktopWindow": 1,
      "GetSysColorBrush": 1,
      "ReadStdoutStderr": 1,
      "EnumChildWindows": 1,
      "GetMenuItemCount": 1,
      "GetOpenFileNameW": 1,
      "wglDeleteContext": 1,
      "UnregisterClassW": 1,
      "SafeArrayCreate": 1,
      "RtlDefaultNpAcl": 1,
      "OpenThreadToken": 1,
      "GetTextMetricsW": 1,
      "GetRawInputData": 1,
      "RegDeleteValueW": 1,
      "SetActiveWindow": 1,
      "TrackMouseEvent": 1,
      "ExcludeClipRect": 1,
      "GetDpiForWindow": 1,
      "GetEnhMetaFileW": 1,
      "camellia128-cts": 1,
      "NotifyWinEvent": 1,
      "CreateProcessW": 1,
      "SizeofResource": 1,
      "GetWindowLongW": 1,
      "CoInitializeEx": 1,
      "TransparentBlt": 1,
      "DeferWindowPos": 1,
      "DragQueryFileW": 1,
      "TrackPopupMenu": 1,
      "EnableMenuItem": 1,
      "EmptyClipboard": 1,
      "AmsiScanBuffer": 1,
      "CoUninitialize": 1,
      "RtlCopyMemory": 1,
      "GetSystemMenu": 1,
      "Process32Next": 1,
      "OpenThemeData": 1,
      "GetWindowRect": 1,
      "Entering into": 1,
      "OleInitialize": 1,
      "CreateActCtxW": 1,
      "GetClassNameW": 1,
      "ShellExecuteW": 1,
      "SysFreeString": 1,
      "wglShareLists": 1,
      "FindResourceW": 1,
      "kernel32.dll": 5,
      "ExtractIconW": 1,
      "OleAut32.dll": 2,
      "GetErrorInfo": 1,
      "SysStringLen": 1,
      "SelectObject": 2,
      "PeekMessageW": 1,
      "Service Pack": 1,
      "comctl32.dll": 1,
      "SetCursorPos": 1,
      "GetTextColor": 1,
      "CreateBitmap": 1,
      "GetDC failed": 1,
      "des3-cbc-md5": 1,
      "DeleteObject": 2,
      "GetKeyState": 1,
      "des-cbc-md5": 2,
      "SwapBuffers": 1,
      "GetSysColor": 1,
      "GetIconInfo": 1,
      "aes128-sha1": 1,
      "DrawMenuBar": 1,
      "DestroyMenu": 1,
      "aes256-sha1": 1,
      "DestroyIcon": 1,
      "aes128-sha2": 1,
      "SetBkColor": 1,
      "User32.dll": 1,
      "GetBkColor": 1,
      "BackupRead": 1,
      "LogonUserW": 1,
      "ShowWindow": 2,
      "BeginPaint": 1,
      "LocalAlloc": 1,
      "MoveWindow": 1,
      "RemoveMenu": 1,
      "LoadImageW": 1,
      "GetVersion": 1,
      "aes128-cts": 1,
      "CreateMenu": 1,
      "GetSubMenu": 1,
      "aes256-cts": 1,
      "DragFinish": 1,
      "GetDlgItem": 1,
      "Void Main": 2,
      "SetParent": 1,
      "FIN_WAIT1": 1,
      "Untrusted": 1,
      "rc4-hmac": 1,
      "Zero": 3,
      "nremote code execution capabilities. Once": 1,
      "nTo facilitate the lateral movement": 1,
      "Base64 encoded PowerShell one-liner": 1,
      "New-Object System.Net.HttpListener": 1,
      "npublic class PortForwardingR": 1,
      "the port forwarding Java tool": 1,
      "the open source JSOCKS tool11": 1,
      "JSOCKS-like tool. This tool": 1,
      "nAnother Java tool that was": 1,
      "session.setPortForwardingR": 2,
      "context.Request.httpmethod": 1,
      "PortForwardingL.java.html": 1,
      "backdoor that simulates": 1,
      "request.contentlength64": 1,
      "System.Web.HttpUtility": 1,
      "StrictHostKeyChecking": 2,
      "listener.Prefixes.Add": 1,
      "custom Java compiled": 1,
      "listener.IsListening": 1,
      "requestUrl.LocalPath": 2,
      "listener.GetContext": 1,
      "context.Request.Url": 1,
      "session.setPassword": 2,
      "URL parameter named": 1,
      "Reflection.Assembly": 1,
      "nThe first backdoor": 1,
      "response.StatusCode": 1,
      "LoadWithPartialName": 1,
      "System.out.println": 2,
      "session.setConfig": 4,
      "nThen the command": 1,
      "context.Response": 1,
      "Integer.parseInt": 4,
      "the JSOCKS tool": 1,
      "routes.Get_Item": 1,
      "Session session": 2,
      "jsch.getSession": 2,
      "context.Request": 1,
      "nFrom backdoor": 1,
      "listener.Start": 1,
      "host.indexOf": 4,
      "Code snippet": 2,
      "POST request": 1,
      "String lhost": 2,
      "System.exit": 2,
      "foo.indexOf": 8,
      "String user": 2,
      "requestUrl": 1,
      "Out-String": 1,
      "System.Web": 1,
      "n11 https": 1,
      "JSch jsch": 2,
      "localPath": 1,
      "UrlDecode": 1,
      "backdoor": 1,
      "u2018kmd": 1,
      "new JSch": 2,
      "n10 http": 1,
      "Out-Null": 1,
      "nFigure": 2,
      "System": 2,
      "u2019": 4,
      "u2026": 2,
      "Usage": 3,
      "nThe": 2,
      "File": 12,
      "The": 48,
      "n15": 1,
      "New": 2,
      "VBS file containing obfuscated PowerShell": 1,
      "u2019s further exploitation and malicious": 1,
      "PowerShell script. Within this script": 1,
      "nThis analysis comprises two samples": 1,
      "this VBS file performs deobfuscation": 1,
      "Once the script successfully decodes": 1,
      "the terminal. This command involves": 1,
      "malicious and highly obfuscated VBS": 1,
      "the startup folder. This technique": 1,
      "using the yWaUTuYIQuUWknat method": 1,
      "nThe initial executable comprises": 1,
      "email using phishing. Red Packet": 1,
      "nAfter persistence VBS goes for": 1,
      "with PowerShell and real binary": 1,
      "two primary stages. The initial": 1,
      "nAfter printing the shell code": 1,
      "obfuscating the malicious DLL": 1,
      "code. After modifying the VBS": 1,
      "nHigh-Level Technical Summary": 1,
      "This malicious software can": 1,
      "u201d method within the DLL": 1,
      "u2019s see how the exploit": 1,
      "obfuscated PowerShell code": 1,
      "u2019t know what this code": 1,
      "with the name utah-Robert": 1,
      "nIt was Invoking its VAI": 1,
      "and the Windows registry": 1,
      "This marks the beginning": 1,
      "nThis final exploit has": 1,
      "nThe VBS has its third": 1,
      "Security defines NJRat": 1,
      "remote access trojan": 1,
      "Dynamic Link Library": 1,
      "u2019s computer from": 1,
      "NJRat was first seen": 1,
      "nThis stage consists": 1,
      "Visual Basic Script": 1,
      "nAfter patching and": 1,
      "string with base64": 1,
      "base64-encoded DLL": 1,
      "was base64 encoded": 1,
      "nExecutive Summary": 1,
      "get the real DLL": 1,
      "execute this DLL": 1,
      "nby Osama Ellahi": 1,
      "nUpon execution": 1,
      "u2019s computer": 1,
      "nInitial Stage": 1,
      "nHow RAT works": 1,
      "nThis version": 1,
      "How RAT works": 2,
      "nExploitation": 1,
      "u2019s screen": 1,
      "u2019s camera": 1,
      "RAT version": 3,
      "Environment": 1,
      "nBy looking": 1,
      "nPublished": 1,
      "Start Menu": 1,
      "Breachnova": 2,
      "Documents": 4,
      "Microsoft": 1,
      "Analysis": 4,
      "nBut let": 1,
      "Programs": 1,
      "u201cVAI": 1,
      "nSHA256": 1,
      "the DLL": 1,
      "AppData": 1,
      "Startup": 2,
      "Windows": 1,
      "Roaming": 1,
      "August": 3,
      "u2019C": 1,
      "Script": 8,
      "nNJRAT": 1,
      "u2019s": 1,
      "Method": 5,
      "nThis": 1,
      "u2018": 2,
      "Users": 1,
      "Copy": 2,
      "RAT": 2,
      "Local Extension Settings": 4,
      "Moonchild Productions": 1,
      "Minecraft RedServer": 1,
      "Minecraft VimeWorld": 1,
      "CoffeeCup Software": 3,
      "TON Crystal Wallet": 1,
      "Vitalwerks DUC x64": 1,
      "DownloadManagerIDM": 1,
      "Minecraft loliland": 1,
      "GNU Privacy Guard": 1,
      "Minecraft McSkill": 1,
      "Total Commander": 1,
      "qBittorrent.ini": 1,
      "GitHub Desktop": 1,
      "ServerList.xml": 1,
      "Vitalwerks DUC": 1,
      "Muon Snowflake": 1,
      "ServerList.cfg": 1,
      "Local Storage": 1,
      "Kalypso Media": 1,
      "Atomic Wallet": 1,
      "Authy Desktop": 1,
      "Coin98 Wallet": 2,
      "FileZilla_PEM": 1,
      "Saturn Wallet": 1,
      "Terra Station": 1,
      "ProgramFiles": 6,
      "AtomicWallet": 1,
      "Settings.reg": 1,
      "confCons.xml": 1,
      "LocalAppData": 20,
      "Jaxx Liberty": 1,
      "cloverWallet": 1,
      "Pixel Worlds": 1,
      "History.json": 1,
      "ElectronCash": 1,
      "Sherrod FTP": 1,
      "KardiaChain": 2,
      "NDSites.ini": 1,
      "Default.ppx": 1,
      "SimonTatham": 1,
      "guildWallet": 1,
      "roninWallet": 1,
      "jaxxLiberty": 1,
      "FTPInfo_CFG": 2,
      "FTPInfo_XML": 1,
      "UserProfile": 14,
      "jDownloader": 2,
      "IncrediMail": 1,
      "qBittorrent": 1,
      "Math Wallet": 1,
      "Thunderbird": 1,
      "FileZilla1": 1,
      "ESTdb2.dat": 2,
      "NexusFile1": 1,
      "PostboxApp": 1,
      "LavaServer": 1,
      "Opera Mail": 4,
      "ExpanDrive": 1,
      "Mailspring": 2,
      "ClassicFTP": 1,
      "NetSarang1": 2,
      "mRemoteNG": 1,
      "Filezilla": 4,
      "Pale Moon": 1,
      "Growtopia": 1,
      "User Data": 6,
      "FTPGetter": 1,
      "PocoMail1": 1,
      "IndexedDB": 1,
      "Staff-FTP": 1,
      "DeluxeFTP": 1,
      "TS3Client": 1,
      "Cyberfox": 1,
      "Bytecoin": 1,
      "WhatsApp": 1,
      "SDRTrunk": 1,
      "Mailbird": 1,
      "NetDrive": 1,
      "PocoMail": 3,
      "Software": 2,
      "FlashFXP": 2,
      "BitKinex": 4,
      "DashCore": 1,
      "Squirrel": 2,
      "NordPass": 1,
      "Litecoin": 1,
      "NovaFTP": 1,
      "The Bat": 1,
      "FTPInfo": 2,
      "Browser": 1,
      "Notepad": 1,
      "Binance": 1,
      "Mozilla": 1,
      "EasyFTP": 1,
      "ShareX": 2,
      "Bither": 1,
      "Exodus": 1,
      "Store": 2,
      "Flock": 1,
      "Slack": 1,
      "Poc": 1,
      "mismatch between ABI description and": 1,
      "Value.SetIterKey called before Next": 1,
      "Other_Default_Ignorable_Code_Point": 1,
      "anonymous but has PkgPath set": 1,
      "MakeFunc with non-Func type": 1,
      "XENIX semaphores available": 1,
      "reflect.Value.SetMapIndex": 1,
      "reflect.Value.SetComplex": 1,
      "reflect.MakeMapWithSize": 1,
      "reflect.MapIter.SetKey": 1,
      "reflect.Value.Pointer": 1,
      "reflect.Value.Slice3": 1,
      "IDS_Trinary_Operator": 1,
      "Terminal_Punctuation": 1,
      "reflect.Value.SetInt": 1,
      "IDS_Binary_Operator": 1,
      "strings.Reader.Seek": 1,
      "returned zero Value": 1,
      "MapIter.Next called": 1,
      "reflect.Value.Equal": 1,
      "reflect.Value.Uint": 1,
      "reflect.Value.Call": 2,
      "reflect.Value.Grow": 1,
      "Old_North_Arabian": 2,
      "illegal AppendInt": 1,
      "Sentence_Terminal": 1,
      "reflect.Value.Int": 1,
      "Old_South_Arabian": 1,
      "Zanabazar_Square": 1,
      "reflect.StructOf": 2,
      "Meroitic_Cursive": 1,
      "reflect.MakeFunc": 1,
      "reflect.nameFrom": 2,
      "FieldByNameFunc": 1,
      "Other_Lowercase": 1,
      "Field index out": 1,
      "Type.Implements": 1,
      "unsafe.Pointer": 1,
      "FormatInt base": 1,
      "Pattern_Syntax": 1,
      "Quotation_Mark": 1,
      "bufio.Scanner": 1,
      "Mende_Kikakui": 1,
      "Masaram_Gondi": 1,
      "Old_Hungarian": 1,
      "invalid Value": 1,
      "Bidi_Control": 1,
      "reflect.Copy": 2,
      "Pahawh_Hmong": 2,
      "Meetei_Mayek": 1,
      "Syloti_Nagri": 1,
      "Sora_Sompeng": 2,
      "Nandinagari": 1,
      "reflect.Set": 1,
      "New_Tai_Lue": 1,
      "Medefaidrin": 1,
      "Old_Sogdian": 1,
      "bad argSize": 1,
      "Soft_Dotted": 1,
      "Old_Persian": 1,
      "Old_Italic": 1,
      "Old_Turkic": 1,
      "zero Value": 1,
      "ParseFloat": 3,
      "Deprecated": 1,
      "Phoenician": 1,
      "Hex_Digit": 1,
      "Malayalam": 1,
      "ParseUint": 2,
      "Mongolian": 2,
      "Samaritan": 1,
      "nil Type": 2,
      "Ugaritic": 1,
      "Tai_Viet": 1,
      "inCount": 1,
      "NumOut": 1,
      "crc32": 2,
      "Bits": 2,
      "Elem": 1,
      "Len": 5,
      "nDecrypting obfuscated code using CyberChef": 1,
      "PowerShell script processes several values": 1,
      "includes encoded PowerShell code. This": 1,
      "This reveals the obfuscated sections": 1,
      "nThe following example Python script": 1,
      "nWith the JavaScript code dumped": 1,
      "nWe can beautify the JavaScript": 1,
      "various variables. Further down": 1,
      "nThe second script utilizes the": 1,
      "nThe first script tag contains": 1,
      "sixteen zeros because the AES": 1,
      "nWe pass the final variables": 1,
      "nAfter beautifying the code": 1,
      "hex into CyberChef and set": 1,
      "nThe code also shows that": 1,
      "nDebugging the JavaScript": 1,
      "nAfter obtaining the data": 1,
      "except UnicodeDecodeError": 1,
      "except FileNotFoundError": 1,
      "Find all the script tag": 1,
      "nWith the main code and": 1,
      "demonstrative. However": 1,
      "the AES decryption key": 1,
      "Generic Code Beautify": 1,
      "This indicates that": 1,
      "Convert binary data": 1,
      "nSecond Obfuscation": 1,
      "uses AES encryption": 1,
      "nThird obfuscation": 1,
      "nFirst obfuscation": 1,
      "can use CyberChef": 1,
      "except Exception": 1,
      "nBeautification": 1,
      "Script found": 1,
      "CyberChef": 1,
      "Assuming": 1,
      "For AES": 1,
      "nUsing": 2,
      "Here": 1,
      "nPHF": 3,
      "nHkb": 1,
      "nZhX": 1
    },
    "used_passages": [
      "file_pdf::146e57062c590ff3fd51f262f8060fc04f4823e3014d5fda625a8ee04871d91e::chunk-1",
      "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-15",
      "file_html::08eceae8c0e4410bf44b7b3acfbd7b62a4fc3537351b0ac70f050daa6f9146fe::chunk-0",
      "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-6",
      "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-5",
      "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-7",
      "file_html::2d26af7a7bfafb0d3e22a57c4c803716b2db4848fcf04f2be0d45cea69a90245::chunk-2",
      "file_html::1d457b9340531ad47b43145f343254c9e54d6288de1d1b0573dfb14e24095ceb::chunk-10"
    ],
    "strategy": "redact+rereank+two_stage+post_validate"
  },
  "classification": {
    "llm": [
      "rat",
      "stealer"
    ]
  },
  "final": {
    "score": 0.85,
    "label": "malicious"
  },
  "audit": [
    {
      "ts": "2025-08-24T22:48:57Z",
      "event": "pipeline_start",
      "run_name": "rootkit-run-2508",
      "file": "samples/rootkit/decompressed/a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.exe"
    },
    {
      "ts": "2025-08-24T22:48:57Z",
      "event": "decompile_start"
    },
    {
      "ts": "2025-08-24T22:51:15Z",
      "event": "decompile_ready",
      "path": "analysis/llmrag/llmrag-analysis-rootkit-run-2508/decompile-rootkit-run-2508/a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.features.json"
    },
    {
      "ts": "2025-08-24T22:51:15Z",
      "event": "rag_start",
      "params": {
        "top_k_dense": 50,
        "top_k_keyword": 50,
        "final_top_k": 8,
        "join_mode": "rrf",
        "rerank_top_k": 0,
        "ranker_model": "gpt-4o-mini",
        "sources": []
      }
    },
    {
      "ts": "2025-08-24T22:51:23Z",
      "event": "rag_done",
      "notes": {
        "query_count": 18,
        "top_k_dense": 50,
        "top_k_keyword": 50,
        "join_mode": "rrf",
        "rerank_top_k": 0,
        "final_top_k": 8,
        "filters": {
          "sources": []
        },
        "ranker_model": "gpt-4o-mini",
        "embedding_model": "text-embedding-3-small",
        "metric": "cosine_similarity",
        "dense_hits": 507,
        "keyword_hits": 50,
        "fused_unique": 550,
        "elapsed_ms": 7768
      }
    },
    {
      "ts": "2025-08-24T22:51:23Z",
      "event": "llm_start_guardrailed",
      "params": {
        "model": "gpt-4o-2024-08-06",
        "temperature": 0.0,
        "max_tokens": 1024
      }
    },
    {
      "ts": "2025-08-24T22:51:48Z",
      "event": "llm_done",
      "path": "analysis/llmrag/llmrag-analysis-rootkit-run-2508/a829694cec2fbcc05aa42f4701f10e043726baade1907faa0c76b458542b88f6.llmrag.json"
    }
  ]
}